<!-- NAVBAR -->
<div class="navbar">
  <div class="navbar-left">
    <img src="assets/img/logo.png" alt="Filmosphere Logo" class="logo-img" />
    <h1 class="logo" (click)="goHome()" style="cursor: pointer;">FILMOSPHERE</h1>
  </div>

  <!-- ðŸ” Search & Filter Films -->
  <div class="nav-link-wrapper">
    <a class="nav-link" routerLink="/film-search" routerLinkActive="active">
      <i class="pi pi-search"></i>
      <span>Search & Filter Films</span>
    </a>
  </div>

  <!-- ðŸ‘¥ Search Users -->
  <div class="nav-link-wrapper">
    <a class="nav-link" routerLink="/user-search" routerLinkActive="active">
      <i class="pi pi-users"></i>
      <span>Search Users</span>
    </a>
  </div>

  <!-- ðŸŽ¬ Recommendation Chat -->
  <div class="nav-link-wrapper">
    <a class="nav-link" routerLink="/recommendation-chat" routerLinkActive="active">
      <i class="pi pi-comments"></i>
      <span>Recommendation Chat</span>
    </a>
  </div>

  <!-- ðŸ‘¤ Profile / Avatar -->
  <div class="navbar-right profile-menu-trigger" (click)="profileMenu.toggle($event)">
    <p-avatar 
      *ngIf="navbarAvatarImage"
      [image]="navbarAvatarImage"
      shape="circle"
      style="width:50px; height:50px;">
    </p-avatar>

    <p-avatar 
      *ngIf="!navbarAvatarImage && navbarAvatarLabel"
      [label]="navbarAvatarLabel"
      shape="circle"
      style="background:#e50914; color:white; width:50px; height:50px; font-size:20px;">
    </p-avatar>

    <span class="username">{{ navbarUsername || 'Guest' }}</span>
    <i class="pi pi-chevron-down dropdown-arrow"></i>
  </div>
</div>

<p-popover 
  #profileMenu 
  appendTo="body" 
  [style]="{width: '230px', background: '#1a1a1a', border: '1px solid #333', borderRadius: '8px'}" 
  styleClass="profile-dropdown-panel"
>
  <p-menu [model]="menuItems"></p-menu>
</p-popover>

<div class="list-detail-container">
  <div *ngIf="loading" class="loading">Loading list...</div>

  <div *ngIf="!loading && list" class="list-detail">
    <div class="list-header">
      <div class="list-title-section">
        <h1>{{ list.title }}</h1>
        <p *ngIf="list.description" class="list-description">{{ list.description }}</p>
        <p *ngIf="!list.description" class="list-description no-description">No description</p>
        <div class="list-meta">
          <span class="film-count">{{ list.films_count || 0 }} films</span>
          <span class="list-author">by {{ list.username || 'Unknown' }}</span>
        </div>
      </div>
    </div>

    <!-- List Items -->
    <div *ngIf="list.items && list.items.length > 0" class="films-grid">
      <div *ngFor="let item of list.items" class="film-card" (click)="goToFilm(item.film_imdb_id)">
        <img [src]="item.film_poster_url || item.film_poster || '/assets/default-poster.jpg'" 
             [alt]="item.film_title" 
             class="film-poster"
             onerror="this.src='/assets/default-poster.jpg'">
        <div class="film-info">
          <h3>{{ item.film_title || 'Unknown Film' }}</h3>
          <p *ngIf="item.film_year">{{ item.film_year }}</p>
        </div>
      </div>
    </div>
    
    <div *ngIf="!list.items || list.items.length === 0" class="empty-list">
      <i class="pi pi-list" style="font-size: 3rem; color: #666; margin-bottom: 1rem;"></i>
      <p>No films in this list yet.</p>
    </div>
  </div>

  <div *ngIf="!loading && !list" class="error-state">
    <p>List not found.</p>
    <p-button label="Go to Profile" icon="pi pi-arrow-left" 
      (click)="goToProfile()" 
      styleClass="p-button-secondary"></p-button>
  </div>
</div>

